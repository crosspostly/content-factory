# Auto-Fix Agent Master Configuration ü§ñ
# –û–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –≤—Å–µ–≥–æ!

# ===== AI MODEL SELECTION =====
ai_models:
  # –ü—Ä—è–º–∞—è –≤—ã–±–æ—Ä –∫–∞–∫–æ—é –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
  # –û–ø—Ü–∏–∏: 'gemini' | 'qwen' | 'dual'
  # 
  # gemini - –¢–æ–ª—å–∫–æ Gemini 2.5 Flash (–±—ã—Å—Ç—Ä–æ)
  # qwen   - –¢–æ–ª—å–∫–æ Qwen 3 Max (–≥–ª—É–±–æ–∫–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
  # dual   - –û–±–µ –º–æ–¥–µ–ª–∏ + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ (—Å–∞–º–æ–µ –º–æ—â–Ω—ã–µ)
  primary: 'gemini'  # ‚Üê –ú–ï–ù–Ø–ô –≠–¢–û! —Ç–∏–ø—ã: gemini | qwen | dual

  # –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
  gemini:
    enabled: true
    model: 'gemini-2.5-flash'
    timeout: 30  # seconds
    max_tokens: 4096
    temperature: 0.3  # –ü–Ω–∏–∂–∞—é—Ç —Ö–∞–æ—Ç–∏—á–Ω–æ—Å—Ç—å, –±–æ–ª—å—à–µ —Å–ø–æ–∫–æ–π–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
    description: 'Fast, real-time analysis'
    secret_key: 'GOOGLE_AI_API_KEY'  # GitHub Secret name

  qwen:
    enabled: true  # –ù–¢–ï–ü–ï–†–¨ –û–ù –í–ö–õ–Æ–ß–ï–ù! –ö–ª—é—á–∏ —É–∂–µ –≤ GitHub Secrets
    model: 'qwen-max'
    base_url: 'https://dashscope.aliyuncs.com/compatible-mode/v1'  # OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π
    timeout: 60
    max_tokens: 8192
    temperature: 0.2  # –ï—â–µ –Ω–∏–∂–µ –¥–ª—è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏
    description: 'Deep analysis, free tier (2000 req/day from local CLI)'
    secret_key: 'QWEN_ACCESS_TOKEN'  # GitHub Secret name
    source: 'local-qwen-code'  # –í—ã—Ç–∞—â–µ–Ω–æ –∏–∑ C:\Users\varsm\.qwen\oauth_creds.json

  dual:
    enabled: false  # –û–∫–ª—é—á–∏ –æ–±–µ –º–æ–¥–µ–ª–∏?
    strategy: 'compare'  # –û–ø—Ü–∏–∏: 'compare' | 'vote' | 'best'
    # compare - –û–±—ä–µ–¥–∏–Ω–∏ –æ–±–∞ –≤—ã–≤–æ–¥–∞
    # vote    - –í—ã–±–µ—Ä–∏ –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –±–æ–ª—å—à–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
    # best    - Gemini –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏, Qwen –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
    description: 'Double-check with both models'

# ===== SAFETY & CONTEXT =====
safety:
  # –ö–æ–Ω—Ç–µ–∫—Å—Ç - –ø—Ä–æ–ø–æ—Ä—Ü–∏—è –æ—à–∏–±–∫–∏ –∫ —É—Å–ø–µ—à–Ω—ã–º —Å—Ç—Ä–æ–∫–∞–º
  context_ratio: 0.3  # 30% –æ—à–∏–±–∫–∏ + 70% —É—Å–ø–µ—Ö–∞ = –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ
  
  # –ù–µ –¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ-—Ñ–∏–∫—Å –¥–ª—è —ç—Ç–∏—Ö –æ—à–∏–±–æ–∫
  # (–¥–∞–∂–µ –µ—Å–ª–∏ –ú–õ —É–≤–µ—Ä–µ–Ω)
  dangerous_keywords:
    # –ù–∞—Ç—Ä–∞–≤ —ç—Ç–∏ - –∏—Å–ø–æ–ª—å–∑—É–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é
    - 'DROP TABLE'       # SQL –∏–Ω—ä–µ–∫—Ü–∏—è
    - 'DELETE FROM'      # –≠—Ç–æ —Å–ª—é –≤—ã–≥–ª—è–¥–∏—Ç –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–º
    - 'rm -rf /'         # –¥–∞–∂–µ –Ω–µ –¥—É–º–∞—Ç—å
    - 'chmod 777'        # –û–ø–∞—Å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤
    - 'reboot'           # –ù–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å CI
    - 'sudo'             # –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –≤–ª–∞—Å—Ç–∏ —è–≤–Ω–æ
    - 'secret'           # –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –Ω–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ
    - 'password'         # –í—Ç–æ—Ä–æ–µ
    - 'token'            # –¢—Ä–µ—Ç—å–µ
    - 'export AWS'       # –¢–æ—á–Ω–æ –Ω–µ—Ç

  # –ù–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–∏–∫—Å—ã –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–µ–∂–Ω–∏–µ –æ—à–∏–±–æ–∫
  caution_keywords:
    - 'database'         # –≠—Ç–æ –¥–µ–ª–∏–∫–∞—Ç–Ω–∞—è –≤–µ—â—å
    - 'migrate'          # –ú–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –æ–ø–∞—Å–Ω—ã
    - 'backup'           # –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ
    - 'restore'          # —Ç–æ —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å backup
    - 'config'           # –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞—Å—Å—á—ë—Ç—ã
  dont_auto_fix_keywords:
    - 'large file upload'  # –ú–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞—Å—Å—á—ë—Ç–∞–º–∏
    - 'large data'         # –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ

# ===== CONTEXT UNDERSTANDING =====
context:
  # –ö–∞–∫ –∞–≥–µ–Ω—Ç –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç?
  # –û–Ω —à—Ç—É–¥–∏—Ä—É–µ—Ç:
  
  include_project_config: true
    # –ß–∏—Ç–∞–µ—Ç projects/*/config.yaml
    # –ü–æ–Ω–∏–º–∞–µ—Ç project-—Å–ø–µ—Ü–∏—Ñ–∏–∫–æ–≤
  
  include_recent_commits: true
    # –ü–æ–º–∏–Ω–∞–µ—Ç –Ω–∞–ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∫–æ–º–º–∏—Ç–∞
    # –§–∏–∫—Å–∏—Ä—É–µ—Ç –æ–ø–∞—Å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  
  include_test_history: true
    # –ù–µ –Ω–∞–≤—Ç–æ–ø—ã–≤–∞–µ—Ç –ø—Ä–µ–∂–Ω–∏–µ –æ—à–∏–±–∫–∏
    # –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–∏–∫—Å—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è 
    # –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
  
  include_readme: true
    # –û—á–µ–Ω—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ! –ü–æ–Ω–∏–º–∞–µ—Ç –∂–µ–ª–∞–µ–º–æ–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

  system_prompt_template: |
    You are an expert DevOps engineer and code reviewer.
    
    CRITICAL CONSTRAINTS:
    1. ONLY analyze error logs - never modify unrelated files
    2. NEVER touch configuration unless error is about that config
    3. NEVER run expensive operations (migrations, backups, deploys)
    4. If you see dangerous keywords: {dangerous_keywords}, REFUSE to auto-fix
    5. If you see caution keywords: {caution_keywords}, require manual review
    6. ALWAYS include the context about recent changes
    7. NEVER suggest fixes that could cause side effects
    
    Current project context:
    - Recent changes (last 3 commits)
    - Test history (what passed before)
    - Project structure (from config.yaml)
    
    When suggesting a fix:
    1. Analyze ONLY the immediate error
    2. Check if your fix could break other tests
    3. Verify the fix doesn't introduce security issues
    4. Confirm no side effects to other modules
    5. Ask for human review if uncertain

# ===== AUTO-FIX BEHAVIOR =====
auto_fix:
  enabled: true
  
  # –ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç PR –≤—Å–µ–≥–¥–∞
  create_issue: true
  create_pr: true
  
  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ü–†
  # 0.7 = –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 70% —É–≤–µ—Ä–µ–Ω–∞
  min_confidence: 0.7
  
  # –ù–µ –Ω–∞–≤—Ç–æ–ø—ã–≤–∞—Ç—å –ø—Ä–µ–∂–Ω–∏–µ PR –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∑–∞–∫–æ—Ä—ã—á–µ–Ω—ã
  max_open_prs: 3
  skip_if_recent_fix: true  # –ù–µ —Ñ–∏–∫—Å–∏—Ç—å —Å –æ–¥–Ω–æ—é –æ—à–∏–±–∫–æ—é 2 —Ä–∞–∑–∞ –∑–∞ –º–∏–Ω—É—Ç—É

# ===== LOGGING & DEBUG =====
logging:
  level: 'INFO'  # DEBUG | INFO | WARNING | ERROR
  save_artifacts: true
  save_analysis: true
  include_tokens_used: true

# ===== QWEN OAUTH CREDENTIALS =====
# –¶–≤–µ—Ç–æ–≤–æ–¥ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–π:
qwen_credentials:
  source: 'C:\\Users\\varsm\\.qwen\\oauth_creds.json'  # –û—Ç–∫—É–¥–∞ –≤—ã—Ç–∞—â–µ–Ω–æ
  extracted_at: '2025-12-12T16:45:00Z'  # –ö–æ–≥–¥–∞
  access_token_secret: 'QWEN_ACCESS_TOKEN'  # GitHub Secret name
  refresh_token_secret: 'QWEN_REFRESH_TOKEN'  # –ù–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –∏—Å—Ç–µ—á—ë—Ç
  expiry_date: 1765543004617  # milliseconds, –∏—Å—Ç–µ–∫–∞–µ—Ç –≤ —Ñ–µ–≤—Ä–∞–ª–µ 2025
  note: '–ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å Qwen Code CLI (github.com/QwenLM/qwen-code)'
