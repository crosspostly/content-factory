name: Test Qwen Token (Simple)

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Install Python deps
        run: pip install requests
      
      - name: Test Qwen Token
        env:
          QWEN_ACCESS_TOKEN: ${{ secrets.QWEN_REFRESH_TOKEN }}
        run: |
          python3 << 'EOF'
          import requests
          import os
          import json
          
          token = os.getenv('QWEN_ACCESS_TOKEN')
          print(f"Token: {token[:10]}...")
          
          if not token:
              print("ERROR: Token is empty!")
              exit(1)
          
          # Try different endpoints
          endpoints = [
              ("DashScope Intl Models", "https://dashscope-intl.aliyuncs.com/api/v1/models"),
              ("DashScope CN Models", "https://dashscope.aliyuncs.com/api/v1/models"),
              ("Qwen API Text", "https://qwenlm.aliyun.com/api/v1/text/generate"),
          ]
          
          for name, url in endpoints:
              print(f"\nðŸ“Œ Testing: {name}")
              print(f"   URL: {url}")
              try:
                  response = requests.get(
                      url,
                      headers={
                          "Authorization": f"Bearer {token}",
                          "Content-Type": "application/json"
                      },
                      timeout=5
                  )
                  print(f"   Status: {response.status_code}")
                  if response.text:
                      print(f"   Response: {response.text[:200]}")
                  if response.status_code == 200:
                      print(f"   âœ… THIS WORKS!")
              except Exception as e:
                  print(f"   âŒ Error: {e}")
          
          EOF
