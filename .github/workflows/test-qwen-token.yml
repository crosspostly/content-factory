name: Test Qwen Token (Simple)

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Install Python deps
        run: pip install requests
      
      - name: Test Qwen Token
        env:
          QWEN_ACCESS_TOKEN: ${{ secrets.QWEN_REFRESH_TOKEN }}
        run: |
          python3 << 'EOF'
          import requests
          import os
          
          token = os.getenv('QWEN_ACCESS_TOKEN')
          print(f"Token received: {token[:10] if token else 'EMPTY'}...")
          
          if not token:
              print("ERROR: Token is empty!")
              exit(1)
          
          print("Testing Qwen API with Bearer token...")
          
          # Test with Qwen API - example: list models
          response = requests.get(
              "https://dashscope-intl.aliyuncs.com/api/v1/models",
              headers={
                  "Authorization": f"Bearer {token}",
                  "Content-Type": "application/json"
              }
          )
          
          print(f"Status Code: {response.status_code}")
          print(f"Response: {response.text[:500]}")
          
          if response.status_code == 200:
              print("✅ SUCCESS! Token works with Qwen API!")
          else:
              print(f"❌ FAILED with {response.status_code}")
          EOF
