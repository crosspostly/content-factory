# ğŸ—ºï¸ CONTENT FACTORY â€” ĞŸĞĞ›ĞĞĞ¯ Ğ”ĞĞ ĞĞ–ĞĞĞ¯ ĞšĞĞ Ğ¢Ğ

**Ğ”Ğ°Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°:** 2025-12-12  
**Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ´Ğ°Ñ‚Ğ°:**  2025-12-31 (MVP ready)

---

## ğŸ“Š Ğ’Ğ¡Ğ• Ğ¤ĞĞ—Ğ« ĞĞ ĞĞ”ĞĞĞ™ Ğ¡Ğ¢Ğ ĞĞĞ˜Ğ¦Ğ•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 0: PREP (2025-12-12)                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… DONE: Parts 1-8 (Spec + Stubs Ğ½Ğ° Ğ²ĞµÑ‚ĞºĞµ feature/horoscope-project)â”‚
â”‚ ğŸ”„ NOW: ĞœĞµÑ€Ğ¶Ğ¸Ğ¼ Part 1-8 â†’ main                                      â”‚
â”‚ â° DEADLINE: ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ 10:00 AM                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: CORE IMPLEMENTATION (2025-12-12 10:00 â†’ 2025-12-15)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSIGNEE: GitHub Copilot                                            â”‚
â”‚ BRANCHES: feature/copilot-* (Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ)                    â”‚
â”‚ TARGET: main                                                        â”‚
â”‚                                                                     â”‚
â”‚ ğŸ¯ ISSUE #1: Model Router (LLM Fallbacks)                           â”‚
â”‚   ğŸ“ Branch: feature/copilot-model-router                           â”‚
â”‚   â° ETA: 1 Ğ´ĞµĞ½ÑŒ                                                     â”‚
â”‚   ğŸ“¦ File: core/utils/model_router.py                               â”‚
â”‚   âœ… Tests: tests/test_model_router.py                              â”‚
â”‚                                                                     â”‚
â”‚ ğŸ¯ ISSUE #2: Pipeline Orchestrator (CLI)                            â”‚
â”‚   ğŸ“ Branch: feature/copilot-pipeline-orchestrator                  â”‚
â”‚   â° ETA: 1.5 Ğ´Ğ½Ñ                                                    â”‚
â”‚   ğŸ“¦ File: core/orchestrators/pipeline_orchestrator.py              â”‚
â”‚   âœ… Tests: tests/test_pipeline.py                                  â”‚
â”‚                                                                     â”‚
â”‚ ğŸ¯ ISSUE #3: Project Config & Defaults                              â”‚
â”‚   ğŸ“ Branch: feature/copilot-project-config                         â”‚
â”‚   â° ETA: 0.5 Ğ´Ğ½Ñ                                                    â”‚
â”‚   ğŸ“¦ Files: projects/youtube_horoscope/config.yaml                  â”‚
â”‚            projects/youtube_horoscope/content_plan.json             â”‚
â”‚            projects/youtube_horoscope/prompts/*.txt                 â”‚
â”‚   âœ… Sample: Example horoscope config                               â”‚
â”‚                                                                     â”‚
â”‚ ğŸ¯ ISSUE #4: Tests & CI/CD                                          â”‚
â”‚   ğŸ“ Branch: feature/copilot-tests-ci                               â”‚
â”‚   â° ETA: 1 Ğ´ĞµĞ½ÑŒ                                                     â”‚
â”‚   ğŸ“¦ Files: .github/workflows/test.yml                              â”‚
â”‚            tests/conftest.py                                        â”‚
â”‚            tests/test_*.py (all modules)                            â”‚
â”‚                                                                     â”‚
â”‚ MERGE STRATEGY: Each branch â†’ separate PR â†’ review â†’ merge          â”‚
â”‚ ORDER: 1 â†’ 3 â†’ 2 â†’ 4 (dependencies matter!)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: MVP VALIDATION (2025-12-16 â†’ 2025-12-20)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSIGNEE: You + Copilot                                             â”‚
â”‚ GOAL: ĞŸÑ€Ğ¾Ğ¹Ñ‚Ğ¸ Ğ²ÑĞµ 5 Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸Ğ· Definition of Done                     â”‚
â”‚                                                                     â”‚
â”‚ âœ… Test 1: Generate shorts (--dry-run)                              â”‚
â”‚ âœ… Test 2: Generate long-form (--dry-run)                           â”‚
â”‚ âœ… Test 3: LLM fallbacks (Gemini â†’ Ollama)                          â”‚
â”‚ âœ… Test 4: TTS fallbacks (Gemini TTS â†’ Edge-TTS)                    â”‚
â”‚ âœ… Test 5: YouTube upload (real video to YT)                        â”‚
â”‚                                                                     â”‚
â”‚ If ALL PASS â†’ ğŸ‰ MVP READY                                          â”‚
â”‚ If FAIL â†’ debug + fix + retry                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: PRODUCTION OPTIMIZATIONS (2025-12-21 â†’ 2025-12-31)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ASSIGNEE: You (priority-based selection)                            â”‚
â”‚                                                                     â”‚
â”‚ ğŸ”„ [OPTIONAL] Performance Tuning                                    â”‚
â”‚    - Add caching layer (redis/filesystem)                           â”‚
â”‚    - Parallelize TTS synthesis                                      â”‚
â”‚    - Optimize video rendering                                       â”‚
â”‚                                                                     â”‚
â”‚ ğŸ”„ [OPTIONAL] Social Media Uploaders                                â”‚
â”‚    - TikTok uploader implementation                                 â”‚
â”‚    - Instagram uploader implementation                              â”‚
â”‚    - VK uploader implementation                                     â”‚
â”‚                                                                     â”‚
â”‚ ğŸ”„ [OPTIONAL] Advanced Features                                     â”‚
â”‚    - Thumbnail generation                                           â”‚
â”‚    - A/B testing framework                                          â”‚
â”‚    - Analytics integration                                          â”‚
â”‚                                                                     â”‚
â”‚ ğŸ”„ [OPTIONAL] New Content Types                                     â”‚
â”‚    - Tarot readings                                                 â”‚
â”‚    - Angel card readings                                            â”‚
â”‚    - Affirmation videos                                             â”‚
â”‚                                                                     â”‚
â”‚ SCOPE: Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑˆÑŒ ÑĞ°Ğ¼ (Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ¸ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ¾Ğ²)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ PHASE 0: PREP (Ğ¡Ğ•Ğ“ĞĞ”ĞĞ¯)

### Ğ¨Ğ°Ğ³ 1: ĞœĞµÑ€Ğ¶Ğ¸Ğ¼ Parts 1-8 Ğ² main
```bash
# Ğ¢Ñ‹ Ğ´ĞµĞ»Ğ°ĞµÑˆÑŒ:
git checkout feature/horoscope-project
git add .
git commit -m "Part 8: Complete utils (config_loader, secrets_manager, tts_router, logging_utils)"
git push origin feature/horoscope-project

# GitHub UI:
# 1. Create PR from feature/horoscope-project â†’ main
# 2. Title: "Parts 1-8: Complete Content Factory Foundation"
# 3. Description: (see template below)
# 4. Merge â†’ Squash and merge (clean history)

# ĞŸĞ¾ÑĞ»Ğµ merge:
git checkout main
git pull origin main
```

**PR Description Template:**
```markdown
## ğŸ“¦ What's included

- âœ… Part 1: Script Generator (stub)
- âœ… Part 2: TTS Generator (stub)
- âœ… Part 3: Video Renderer (stub)
- âœ… Part 4: YouTube Uploader (stub)
- âœ… Part 5: Stock Client (stub)
- âœ… Part 6: TTS Router (stub)
- âœ… Part 7: Generators stubs
- âœ… Part 8: Utils stubs

## ğŸ“„ Reference
- Full spec: [TECH_SPEC_PIPELINE.md](TECH_SPEC_PIPELINE.md)
- Roadmap: [ROADMAP.md](ROADMAP.md)

## âœ¨ Ready for
Phase 1: Copilot Implementation
```

**Status after merge:**
```
main/
â”œâ”€â”€ TECH_SPEC_PIPELINE.md âœ…
â”œâ”€â”€ ROADMAP.md (this file) âœ…
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ generators/ âœ… (all stubs)
â”‚   â”œâ”€â”€ uploaders/ âœ… (all stubs)
â”‚   â”œâ”€â”€ utils/ âœ… (all stubs)
â”‚   â””â”€â”€ orchestrators/ âŒ (NOT YET)
â”œâ”€â”€ projects/ âŒ (NOT YET â€” created in Phase 1)
â”œâ”€â”€ tests/ âŒ (NOT YET â€” created in Phase 1)
â””â”€â”€ .github/workflows/ âŒ (NOT YET â€” created in Phase 1)
```

---

## ğŸ¤– PHASE 1: CORE IMPLEMENTATION (Copilot Issues)

### ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ: 1 â†’ 3 â†’ 2 â†’ 4

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ñ‚Ğ°ĞºĞ¾Ğ¹ Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº?**
- Issue #1 (model_router) â†’ Ğ±Ğ°Ğ·Ğ¸Ñ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ñ…
- Issue #3 (project_config) â†’ Ğ½ÑƒĞ¶ĞµĞ½ Ğ´Ğ»Ñ pipeline
- Issue #2 (orchestrator) â†’ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¾Ğ±Ğ° Ğ¸Ğ· #1 Ğ¸ #3
- Issue #4 (tests) â†’ Ñ‚ĞµÑÑ‚Ğ¸Ñ‚ Ğ²ÑĞµ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ

---

### ğŸ“Œ ISSUE #1: Implement Model Router

```yaml
Title: "[COPILOT] Implement Model Router (LLM Fallbacks)"
Assignee: "@github-copilot"
Branch: feature/copilot-model-router
ETA: 1 day
Dependencies: None
```

**Full description:**
```markdown
## ğŸ¯ Goal
Implement `core/utils/model_router.py` â€” LLM routing with fallback chains.

## ğŸ“‹ Requirements

### File to Create
- `core/utils/model_router.py`

### Main Function Signature
```python
def generate_text(
    config: ProjectConfig,
    prompt: str,
    system_prompt: str | None = None,
    model_hint: str | None = None,
    temperature: float | None = None
) -> str:
    """
    Generate text using LLM with automatic fallbacks.
    
    Fallback chain (from config.generation.provider_priority):
    1. Gemini (gemini-2.5-flash)
    2. Ollama (gemma3:4b)
    3. OpenRouter (qwen-2.5-72b)
    
    Error handling:
    - 401/403 (auth error): skip to next provider
    - 429 (rate limit): retry with exponential backoff (max_retries from config)
    - Timeout: retry with backoff
    - After all retries exhausted: raise with full traceback
    
    Returns: Generated text (string)
    Raises: Exception with fallback chain info if all providers fail
    """
```

### Sub-functions to Implement
- `_get_next_provider(current: str, config) -> str | None`
- `_call_gemini(prompt, system_prompt, config) -> str`
- `_call_ollama(prompt, system_prompt, config) -> str`
- `_call_openrouter(prompt, system_prompt, config) -> str`
- `_retry_with_backoff(func, max_retries, delay_sec) -> Any`

### Tests Required (in `tests/test_model_router.py`)
```python
def test_generate_text_success_gemini():
    # Should return text when Gemini is available
    pass

def test_generate_text_fallback_gemini_to_ollama():
    # Should fallback from Gemini to Ollama when Gemini returns 401
    pass

def test_generate_text_retry_on_429():
    # Should retry with exponential backoff on 429 (rate limit)
    pass

def test_generate_text_timeout():
    # Should handle timeout and retry
    pass

def test_generate_text_all_fail():
    # Should raise Exception with fallback chain info if all providers fail
    pass

def test_model_hint():
    # Should skip to specific model when model_hint provided
    pass
```

### Acceptance Criteria
- âœ… `generate_text()` works with Gemini API
- âœ… Falls back to Ollama on 401/403
- âœ… Falls back to OpenRouter on subsequent failure
- âœ… Retries on 429 with exponential backoff
- âœ… Handles timeout gracefully
- âœ… Logs all fallbacks via logging_utils.log_fallback()
- âœ… All tests pass
- âœ… No hardcoded API keys (uses secrets_manager)

### Links
- [TECH_SPEC section](TECH_SPEC_PIPELINE.md#llm-Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ-model_routerpy)
```

---

### ğŸ“Œ ISSUE #3: Create Project Config & Defaults

```yaml
Title: "[COPILOT] Create Project Config & Default Prompts"
Assignee: "@github-copilot"
Branch: feature/copilot-project-config
ETA: 0.5 day
Dependencies: Issue #1 (completion not required, but reference needed)
```

**Full description:**
```markdown
## ğŸ¯ Goal
Create `projects/youtube_horoscope/` directory with all needed config files.

## ğŸ“‹ Requirements

### Directory Structure to Create
```
projects/youtube_horoscope/
â”œâ”€â”€ config.yaml                 # Main config (see template)
â”œâ”€â”€ content_plan.json           # Weekly content plan
â”œâ”€â”€ prompts/
â”‚   â”œâ”€â”€ shorts_scenario.txt    # Prompt for shorts generation
â”‚   â”œâ”€â”€ long_form_scenario.txt # Prompt for long-form video
â”‚   â””â”€â”€ ad_scenario.txt        # Prompt for ads
â”œâ”€â”€ ads/
â”‚   â””â”€â”€ products.yaml          # Product catalog for ads
â””â”€â”€ cache/                      # Caching directory (auto-created)
```

### File: config.yaml
```yaml
project:
  name: "youtube_horoscope"
  language: "ru"
  niche: "astrology"
  target_audience: "18-45, females, spiritual"

content_strategy:
  shorts:
    frequency: "2x daily (08:00, 20:00 UTC+3)"
    duration_sec: "30-45"
  long_form:
    frequency: "1x weekly (Sunday 10:00 UTC+3)"
    duration_min: "20"
    duration_target: "30"
    duration_max: "45"

generation:
  primary_model: "gemini-2.5-flash"
  fallback_models:
    - "gemma3:4b"
    - "qwen-2.5-72b"
  provider_priority:
    - "gemini"
    - "ollama"
    - "openrouter"
  temperature: 0.8
  max_retries: 3
  retry_delay_sec: 2
  prompt_files:
    shorts_scenario: "projects/youtube_horoscope/prompts/shorts_scenario.txt"
    long_form_scenario: "projects/youtube_horoscope/prompts/long_form_scenario.txt"
    ad_scenario: "projects/youtube_horoscope/prompts/ad_scenario.txt"

audio:
  engines:
    edge_tts:
      enabled: true
      voices:
        - "female_neutral"
        - "female_warm"
        - "female_mysterious"
      speed: 1.0
      pitch: 1.0
    gemini_tts:
      enabled: true
      voices:
        - "Gladia"
      speed: 1.0
  fallback_engine: "edge-tts"
  voice_selection:
    shorts: "edge-tts"
    long_form: "edge-tts"  # Can be upgraded to gemini-tts with quota
    ad: "edge-tts"
  background_music:
    style: "mysterious_ambient"
    volume: 0.3
  sound_effects:
    effects:
      mystical_transition: "sparkle"
      zodiac_sign_appear: "bell"
      coin_sound: "cash"

video:
  shorts:
    format: "1080x1920"
    fps: 30
    codec: "libx264"
    preferred_source: "pixabay_video"
    stock_sources:
      - "pixabay_video"
      - "pexels"
      - "unsplash"
  long_form:
    format: "1920x1080"
    fps: 30
    codec: "libx264"
    preferred_source: "pixabay_video"
    stock_sources:
      - "pixabay_video"
      - "pexels"

upload:
  platforms:
    - "youtube"
  playlist_ids:
    shorts: "PLxxxxx_shorts"
    long_form: "PLxxxxx_longform"
  tags:
    - "Ğ³Ğ¾Ñ€Ğ¾ÑĞºĞ¾Ğ¿"
    - "Ğ°ÑÑ‚Ñ€Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ"
    - "Ğ·Ğ½Ğ°ĞºĞ¸ Ğ·Ğ¾Ğ´Ğ¸Ğ°ĞºĞ°"

caching:
  enabled: true
  ttl_days: 7
  cache_dir: ".cache/stocks"

monitoring:
  telegram_notifications: false  # Set true + add TELEGRAM_BOT_TOKEN
  log_level: "INFO"
```

### File: content_plan.json
```json
{
  "2025-12-12": {
    "shorts": [
      {"content_type": "daily", "zodiac_signs": ["Aries", "Taurus", "Gemini"]},
      {"content_type": "love", "zodiac_signs": ["Cancer", "Leo", "Virgo"]}
    ]
  },
  "2025-12-13": {
    "shorts": [
      {"content_type": "money", "zodiac_signs": ["Libra", "Scorpio", "Sagittarius"]},
      {"content_type": "health", "zodiac_signs": ["Capricorn", "Aquarius", "Pisces"]}
    ]
  },
  "2025-12-15": {
    "long_form": {
      "content_type": "weekly_forecast",
      "special_section": "compatibility",
      "blocks": ["love", "money", "health"]
    }
  }
}
```

### File: prompts/shorts_scenario.txt
You are an astrology expert creating viral YouTube Shorts. Generate engaging horoscopes for specific zodiac signs.

**Rules:**
- Hook (first 2-3 sec): mysterious, intrigue
- Script: practical advice + psychological insight
- CTA: emotional engagement (like/comment/subscribe)
- Duration: ~30 seconds max
- Language: Russian
- Tone: mysterious but accessible

**Output format: Valid JSON**
```json
{
  "hook": "...",
  "content_type": "daily|love|money|health|compatibility|teaser|personality|lucky",
  "zodiac_signs_featured": [...],
  "script": "...",
  "visual_hints": "...",
  "engagement_cta": "...",
  "duration_sec_target": 30,
  "psychological_triggers": ["intrigue", "recognition", "empowerment"],
  "promotion_type": "none|teaser_to_long_form",
  "keywords": [...]
}
```

### File: prompts/long_form_scenario.txt
You are creating a comprehensive weekly astrology forecast video (25-35 minutes).

**Structure:**
- Intro (2 min): Set the astral context
- Love block (11 min): Per-zodiac-sign love forecast with manifestation CTA
- Money block (10 min): Financial outlook with action items
- Health block (7 min): Wellness advice
- Special section (6 min): Compatibility, rituals, or lucky days
- Closing (1.5 min): Teaser to next week

**Output format: Valid JSON** (see TECH_SPEC for full schema)

### File: ads/products.yaml
```yaml
crystal_shop_001:
  name: "Mystical Crystals Collection"
  url: "https://example.com/crystals"
  price: 29.99
  description: "Hand-picked healing crystals"
  cta: "Shop now"

tarot_deck_002:
  name: "Golden Tarot Deck"
  url: "https://example.com/tarot"
  price: 24.99
  description: "Premium quality tarot cards"
  cta: "Get your deck"
```

### Acceptance Criteria
- âœ… All files created in correct locations
- âœ… config.yaml is valid YAML (can be parsed by PyYAML)
- âœ… config.yaml follows TECH_SPEC schema exactly
- âœ… content_plan.json is valid JSON
- âœ… All prompts are written and ready for LLM
- âœ… Directory structure matches file structure diagram
- âœ… Can be loaded by config_loader.load("youtube_horoscope")

### Links
- [TECH_SPEC section](TECH_SPEC_PIPELINE.md#Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ°-config_loaderpy)
```

---

### ğŸ“Œ ISSUE #2: Implement Pipeline Orchestrator

```yaml
Title: "[COPILOT] Implement Pipeline Orchestrator (CLI)"
Assignee: "@github-copilot"
Branch: feature/copilot-pipeline-orchestrator
ETA: 1.5 days
Dependencies: Issue #1 (model_router), Issue #3 (config)
```

**Full description:**
```markdown
## ğŸ¯ Goal
Implement `core/orchestrators/pipeline_orchestrator.py` â€” the main entry point.

## ğŸ“‹ Requirements

### File to Create
- `core/orchestrators/pipeline_orchestrator.py`

### CLI Usage
```bash
# Generate shorts (no upload)
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode shorts \
  --date 2025-12-12 \
  --dry-run

# Generate + upload to YouTube
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode long_form \
  --platforms youtube \
  --upload

# Generate ad
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode ad \
  --product-id crystal_shop_001 \
  --upload
```

### Main Function
```python
def main(args):
    """
    1. Load config from projects/{project_name}/config.yaml
    2. Generate script (via script_generator based on mode)
    3. Synthesize audio (via tts_generator)
    4. Render video (via video_renderer)
    5. Upload to platforms (if not dry-run)
    6. Send Telegram notification (if enabled)
    
    Error handling:
    - Any exception â†’ log traceback â†’ send Telegram alert â†’ exit(1)
    """
```

### Sub-functions to Implement
- `_parse_cli_args() -> argparse.Namespace`
- `_get_platforms(args, config) -> list[str]`
- `_validate_mode(mode) -> bool`
- `_run_generation_pipeline(...) -> str` (returns video_path)

### Tests Required (in `tests/test_pipeline.py`)
```python
def test_cli_shorts_dry_run():
    # Should generate shorts without upload
    pass

def test_cli_long_form_dry_run():
    # Should generate long-form without upload
    pass

def test_cli_upload():
    # Should generate + upload to YouTube
    pass

def test_cli_invalid_project():
    # Should raise FileNotFoundError
    pass

def test_cli_invalid_mode():
    # Should raise ValueError
    pass
```

### Acceptance Criteria
- âœ… CLI parses all arguments correctly
- âœ… Generates shorts without upload (--dry-run)
- âœ… Generates long-form without upload (--dry-run)
- âœ… Uploads to YouTube (requires real API key)
- âœ… Handles errors gracefully (logs + Telegram alert)
- âœ… All tests pass
- âœ… Help text available (python -m core.orchestrators.pipeline_orchestrator --help)

### Links
- [TECH_SPEC section](TECH_SPEC_PIPELINE.md#Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹-Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€-pipeline_orchestratorpy)
```

---

### ğŸ“Œ ISSUE #4: Tests & CI/CD

```yaml
Title: "[COPILOT] Implement Tests & GitHub Actions CI/CD"
Assignee: "@github-copilot"
Branch: feature/copilot-tests-ci
ETA: 1 day
Dependencies: Issue #1, #2, #3 (all should be merged first)
```

**Full description:**
```markdown
## ğŸ¯ Goal
Create comprehensive tests and CI/CD pipeline.

## ğŸ“‹ Requirements

### Files to Create
- `tests/conftest.py` (pytest fixtures)
- `.github/workflows/test.yml` (CI/CD)
- `tests/test_model_router.py` (if not created in Issue #1)
- `tests/test_pipeline.py` (if not created in Issue #2)
- `tests/test_config_loader.py`
- `tests/test_script_generator.py`
- `tests/test_tts_generator.py`
- `tests/test_video_renderer.py`

### pytest fixtures (conftest.py)
```python
@pytest.fixture
def sample_config():
    # Return ProjectConfig for youtube_horoscope
    pass

@pytest.fixture
def mock_gemini_api():
    # Mock Gemini API responses
    pass

@pytest.fixture
def mock_ollama():
    # Mock Ollama local model
    pass

@pytest.fixture
def sample_script():
    # Return valid script JSON
    pass

@pytest.fixture
def temp_output_dir():
    # Temporary directory for outputs
    pass
```

### GitHub Actions Workflow (.github/workflows/test.yml)
```yaml
name: Tests & Linting

on:
  push:
    branches: [main, feature/copilot-*]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: 3.11
      
      - name: Install dependencies
        run: pip install -r requirements.txt

      - name: Run pytest
        run: pytest tests/ -v --cov=core --cov-report=term-missing

      - name: Run linting (flake8)
        run: flake8 core/ --max-line-length=120

      - name: Run type checking (mypy)
        run: mypy core/ --ignore-missing-imports
```

### Test Coverage Targets
- âœ… model_router.py: 90%+
- âœ… pipeline_orchestrator.py: 85%+
- âœ… config_loader.py: 95%+
- âœ… Overall coverage: 80%+

### Acceptance Criteria
- âœ… All unit tests pass locally
- âœ… GitHub Actions passes on all commits
- âœ… Coverage report shows 80%+
- âœ… Linting passes (flake8 + mypy)
- âœ… PR cannot be merged without CI/CD passing

### Links
- [TECH_SPEC section](TECH_SPEC_PIPELINE.md#ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸-Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸-definition-of-done)
```

---

## âœ… PHASE 2: MVP VALIDATION (2025-12-16 â†’ 2025-12-20)

After all Phase 1 PRs are merged, run the 5 acceptance tests:

```bash
# Test 1: Generate shorts (no upload)
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode shorts \
  --dry-run
# âœ… Check: output/scripts, output/audio, output/videos all populated

# Test 2: Generate long-form (no upload)
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode long_form \
  --dry-run
# âœ… Check: video is 20-45 min, has chapters, manifestation phrases present

# Test 3: LLM fallbacks
export GOOGLE_AI_API_KEY=""  # Disable Gemini
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode shorts \
  --dry-run
# âœ… Check: logs show "fallback: gemini â†’ ollama"

# Test 4: TTS fallbacks
export GEMINI_TTS_QUOTA_DAILY="0"  # Disable Gemini TTS
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode long_form \
  --dry-run
# âœ… Check: logs show "fallback: gemini-tts â†’ edge-tts"

# Test 5: YouTube upload (real)
python -m core.orchestrators.pipeline_orchestrator \
  --project youtube_horoscope \
  --mode shorts \
  --upload
# âœ… Check: video uploaded to YouTube, ID in logs, metadata correct
```

**If ALL 5 PASS â†’ ğŸ‰ MVP READY TO DEMO**

---

## ğŸš€ PHASE 3: PRODUCTION (2025-12-21 â†’ 2025-12-31)

Choose what to implement based on priority:

| Priority | Feature | Est. Time | Complexity |
|----------|---------|-----------|------------|
| ğŸ”´ HIGH | TikTok uploader | 2 days | Medium |
| ğŸ”´ HIGH | Caching layer | 1 day | Low |
| ğŸŸ¡ MEDIUM | Instagram uploader | 2 days | Medium |
| ğŸŸ¡ MEDIUM | VK uploader | 1 day | Low |
| ğŸŸ¡ MEDIUM | Performance tuning | 2 days | High |
| ğŸŸ¢ LOW | Thumbnail generation | 1.5 days | Medium |
| ğŸŸ¢ LOW | A/B testing framework | 2 days | High |
| ğŸŸ¢ LOW | New content types | Variable | Variable |

---

## ğŸ¯ SUMMARY: WHERE ARE WE NOW?

```
Status: 2025-12-12 09:30 AM

âœ… DONE (PHASE 0):
   â””â”€ Parts 1-8 written (stubs)
   â””â”€ TECH_SPEC_PIPELINE.md created
   â””â”€ This ROADMAP.md created

ğŸ”„ IN PROGRESS (PHASE 0 â†’ PHASE 1):
   â””â”€ Merging Parts 1-8 to main
   â””â”€ Creating Copilot issues

â³ WAITING (PHASE 1):
   â””â”€ Issue #1: Model Router (Copilot)
   â””â”€ Issue #3: Project Config (Copilot)
   â””â”€ Issue #2: Pipeline Orchestrator (Copilot)
   â””â”€ Issue #4: Tests & CI/CD (Copilot)

ğŸ¯ NEXT (PHASE 2):
   â””â”€ Run 5 acceptance tests
   â””â”€ Debug any failures

ğŸš€ FUTURE (PHASE 3):
   â””â”€ Optional production optimizations
```

---

## ğŸ“ QUICK LINKS

- **TECH_SPEC:** [TECH_SPEC_PIPELINE.md](TECH_SPEC_PIPELINE.md)
- **GitHub Issues:** [Create here](https://github.com/crosspostly/content-factory/issues)
- **Pull Requests:** [Monitor here](https://github.com/crosspostly/content-factory/pulls)
- **Main branch:** [View here](https://github.com/crosspostly/content-factory/tree/main)

---

**That's it. Crystal clear. No confusion. ğŸš€**
